{% if form_action is defined %}
    <form action="{{form_action}}" method="post" enctype="multipart/form-data">
{% else %}
    <form id="model_form" action="" method="post" enctype="multipart/form-data">
{% endif %}

<div class="register-form" style="margin:auto; width:40%;">
    {% for field in form %}
        <div class="input-group">
            {{ field(size = 60, class = "form-control login-form", placeholder=field.label.text) }}
            {% if field.name == 'password' %}
                <span class="fa fa-hand-pointer-o" style="color: RGBA(218,211,56,0.5); z-index: 12;" hidden></span>
            {% endif %}
            {% if field.errors %}
                <span class="fa fa-times-circle-o fa-1x" style="color: RGBA(184,16,56,0.5); z-index: 13;"></span>
            {% endif %}
            <span class="fa fa-times-circle-o fa-1x" style="color: RGBA(184,16,56,0.5); z-index: 11;" hidden></span>
            <span class="fa fa-check" style="color: #079493; z-index: 10;" hidden></span>
        </div>
        <a>&nbsp;</a>
    {% endfor %}
</div>
<div class="control-group">
    <div class="reg-footer">
        <div style="float: left">
            {% with messages = get_flashed_messages(with_categories=true) %}
                {% if messages %}
                    {% for category, m in messages %}
                        {% if category %}
                            <div class="savvybi-alert alert-{{ category }} flush-message">
                        {% else %}
                            <div class="savvybi-alert alert-info flush-message">
                        {% endif %}
                        {{ m }}
                        </div>
                    {% endfor %}
                {% elif form.errors %}
                    {% for error in form.errors.items() %}
                      {% if loop.first %}
                        <div class="savvybi-alert alert-danger error-message">{{ error[1][0] }}</div>
                      {% endif %}
                    {% endfor %}
                {% else %}
                {% endif %}
            {% endwith %}
        </div>
        <div style="float: right;">
            <input class="btn btn-primary btn-block form-submit" type="submit" value="{{_('Sign Up')}}">
        </div>
    </div>
</div>
</form>
<script>
    function emailValidation(emailAddress) {
        let pattern = new RegExp(/^(("[\w-\s]+")|([\w-]+(?:\.[\w-]+)*)|("[\w-\s]+")([\w-]+(?:\.[\w-]+)*))(@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$)|(@\[?((25[0-5]\.|2[0-4][0-9]\.|1[0-9]{2}\.|[0-9]{1,2}\.))((25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\.){2}(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\]?$)/i);
        return pattern.test(emailAddress);
    }
    function passwordValidation(password) {
        {#Minimum eight characters, at least one letter and one number:#}
        let pattern = new RegExp(/^(?=.*[A-Za-z])(?=.*\d)[A-Za-z\d]{6,}$/i);
        return pattern.test(password);
    }
</script>